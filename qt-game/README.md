# 迷宫探险游戏 (Maze Adventure Game)

一个使用Qt开发的迷宫探险游戏，具有多种迷宫生成方式和智能陷阱系统。

## 项目结构

```
qt-game/
├── CMakeLists.txt          # CMake构建配置文件
├── README.md              # 项目说明文档
├── example_maze.txt       # 迷宫设计示例
├── build/                 # 构建输出目录
│   └── qt-game           # 可执行文件
├── include/               # 头文件目录
│   ├── advancedimageprocessor.h
│   ├── fog.h
│   ├── game.h
│   ├── imageprocessor.h
│   ├── mainwindow.h
│   ├── mainwindow.ui
│   ├── map.h
│   ├── player.h
│   ├── solver.h
│   └── trap.h
└── src/                   # 源文件目录
    ├── advancedimageprocessor.cpp
    ├── fog.cpp
    ├── game.cpp
    ├── imageprocessor.cpp
    ├── main.cpp
    ├── mainwindow.cpp
    ├── map.cpp
    ├── player.cpp
    ├── solver.cpp
    └── trap.cpp
```

## 游戏特性

### 🎮 核心玩法
- **玩家控制**：使用WASD键控制角色移动
- **血量系统**：玩家有100点血量，踩到陷阱会扣血
- **胜利条件**：到达绿色终点方块
- **游戏结束**：血量耗尽或成功通关

### 🗺️ 地图系统
- **多种地图**：
  - 地图1：经典递归迷宫
  - 地图2：螺旋迷宫
  - 随机地图：Prim算法生成
  - 图片地图：从二值化图片生成
- **视觉效果**：
  - 墙壁：灰色方块
  - 通路：白色方块
  - 起点：蓝色方块
  - 终点：绿色方块

### 🌫️ 迷雾系统
- **迷雾模式**：地图初始为未知状态
- **视野范围**：玩家周围5x5方形区域可见（上下左右各2个方块）
- **探索机制**：已探索区域保持可见，重置时迷雾模式状态保持不变
- **视觉效果**：
  - 未知区域：黑色
  - 已探索区域：半透明黑色
  - 当前视野：完全透明
- **视野形状**：清晰的方形边界，便于玩家判断探索范围

### ⚡ 自动寻路
- **A*算法**：智能路径规划
- **避障能力**：避开墙壁和陷阱
- **实时更新**：从当前位置重新计算路径
- **一键操作**：点击按钮开始/停止自动寻路

### 🕳️ 陷阱系统
- **动态生成**：每3秒随机生成一个陷阱
- **智能消失**：
  - 玩家触发的陷阱：永久消失
  - 自动消失的陷阱：5秒后重新生成
- **安全机制**：不会生成在玩家脚下
- **视觉反馈**：触发时显示红色（0.5秒）

### 🖼️ 图片迷宫生成
- **二值化处理**：支持多种二值化算法
- **智能识别**：自动识别起点和终点
- **格式支持**：PNG、JPG、JPEG、BMP、GIF等
- **缩放适配**：自动缩放到20x20网格

## 技术特性

### 🎯 算法实现
- **A*寻路算法**：智能路径规划
- **大津法二值化**：图像处理算法
- **自适应阈值**：动态阈值计算
- **邻居像素分析**：起点终点智能识别

### 🔧 架构设计
- **模块化设计**：清晰的类职责划分
- **事件驱动**：基于Qt信号槽机制
- **内存管理**：自动资源清理
- **错误处理**：完善的异常处理机制

### 🎨 用户界面
- **现代设计**：清晰的视觉反馈
- **多语言支持**：中英文界面
- **响应式布局**：适配不同屏幕尺寸
- **直观操作**：简单明了的控制界面

## 构建和运行

### 方法一：本地环境构建

#### 环境要求
- Qt 6.8.3 或更高版本
- CMake 3.16 或更高版本
- C++17 编译器

#### 构建步骤
```bash
# 进入项目目录
cd qt-game

# 创建构建目录
mkdir build && cd build

# 配置项目
cmake ..

# 编译项目
make

# 运行游戏
./qt-game
```

### 方法二：Docker容器构建（推荐）

如果你的电脑没有安装Qt6环境，可以使用Docker容器来构建和运行项目。

#### 前置要求
- Docker
- Docker Compose（可选，但推荐）

#### Docker使用步骤

**方式一：使用Docker Compose（推荐）**
```bash
# 进入项目目录
cd qt-game

# 构建并运行容器（自动编译项目）
docker-compose up --build

# 或者后台运行
docker-compose up -d --build

# 查看编译结果
docker-compose logs

# 进入容器进行其他操作
docker-compose exec qt-game-builder bash
```

**方式二：使用Docker命令**
```bash
# 构建镜像
docker build -t qt-game .

# 运行容器并编译项目
docker run -it --rm \
  -v $(pwd):/workspace \
  -e DISPLAY=$DISPLAY \
  --network host \
  qt-game \
  bash -c "cd /workspace/build && cmake .. && make"

# 编译完成后，可执行文件在 build/qt-game
```

#### Docker容器特性
- **自动安装Qt6**：容器内自动下载并安装Qt6.8.3开发环境
- **完整依赖**：包含所有必需的系统库和开发工具
- **隔离环境**：不会影响宿主机环境
- **一键构建**：自动完成配置、编译等步骤

#### 注意事项
- 容器内编译的项目无法直接在宿主机上运行（因为依赖Qt库）
- 如需在宿主机运行，需要安装相同的Qt6版本
- Docker容器主要用于跨平台编译和开发

### 测试脚本
项目包含多个测试脚本：
- `test_image_map.sh`：图片地图生成功能测试
- `test_trap_functionality.sh`：陷阱机制测试
- `test_improved_image_processing.sh`：改进的图片处理测试

## 使用说明

### 基本操作
1. **选择地图**：从预设地图或导入图片生成
2. **开始游戏**：点击"开始游戏"按钮
3. **控制角色**：使用WASD键移动
4. **避开陷阱**：红色方块是陷阱，踩到会扣血
5. **到达终点**：绿色方块是终点，到达即可通关

### 高级功能
1. **迷雾模式**：启用后只能看到周围区域
2. **自动寻路**：AI自动规划最短路径
3. **图片迷宫**：从黑白图片生成自定义迷宫

## 项目特色

### 🎮 游戏体验
- **多样化玩法**：多种地图类型和游戏模式
- **智能AI**：自动寻路和智能陷阱系统
- **视觉效果**：迷雾和陷阱的视觉反馈
- **用户友好**：直观的界面和操作

### 🛠️ 技术亮点
- **模块化架构**：清晰的代码组织
- **算法丰富**：多种经典算法实现
- **图像处理**：先进的二值化技术
- **跨平台支持**：基于Qt的跨平台特性

这是一个功能完整、架构清晰的迷宫游戏项目，展示了C++编程、Qt框架使用、算法实现和图像处理等多方面的技术能力。